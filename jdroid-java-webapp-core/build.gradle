apply plugin: 'com.jdroid.java.library'

ext.PROJECT_NAME = 'Jdroid Java Web App'
description = 'Jdroid library for Java Web apps'

ext.SPRING_VERSION = '3.2.18.RELEASE'

configurations.all {
	// check for updates every build
	resolutionStrategy.cacheChangingModulesFor 0, 'seconds'
}

buildscript {
	dependencies {
		classpath 'com.jdroidtools:jdroid-gradle-java-plugin:' + JDROID_GRADLE_PLUGIN_VERSION
	}
}

dependencies {

	// Jdroid dependencies

	if (jdroid.propertyResolver.getBooleanProp("JDROID_JAVA_AS_PROJECT_DEPENDENCY", false)) {
		implementation project(":jdroid-java-core")
		implementation project(":jdroid-java-remote-config")
	} else {
		implementation 'com.jdroidtools:jdroid-java-core:' + JDROID_JAVA_VERSION
		implementation 'com.jdroidtools:jdroid-java-remote-config:' + JDROID_JAVA_VERSION
	}

	if (jdroid.propertyResolver.getBooleanProp("JDROID_JAVA_HTTP_AS_PROJECT_DEPENDENCY", false)) {
		compile project(":jdroid-java-http-core")
	} else {
		compile ('com.jdroidtools:jdroid-java-http-core:' + JDROID_JAVA_HTTP_VERSION) {
			exclude module: 'jdroid-java-core'
		}
	}

	// Sentry
	// https://github.com/getsentry/sentry-java
	compile 'com.getsentry.raven:raven:8.0.2'

	// Logging
	compile "log4j:log4j:1.2.17"
	compile "org.slf4j:slf4j-log4j12:1.7.25"

	// Spring
	compile "org.springframework:spring-core:" + SPRING_VERSION
	compile "org.springframework:spring-web:" + SPRING_VERSION
	compile "org.springframework:spring-webmvc:" + SPRING_VERSION
	compile "org.springframework:spring-context-support:" + SPRING_VERSION

	// Jackson
	// TODO Remove these dependencies, and replace MappingJackson2HttpMessageConverter by a GsonHttpMessageConverter on Spring 4.1
	compile "com.fasterxml.jackson.core:jackson-core:2.8.7"
	compile "com.fasterxml.jackson.core:jackson-databind:2.8.7"
	compile "com.fasterxml.jackson.core:jackson-annotations:2.8.7"

	// Servlet API
	compile "javax.servlet:servlet-api:2.5"

	compile "org.json:json:20131018"

	// Testing
	testImplementation "org.testng:testng:6.8.21"
	testImplementation "org.mockito:mockito-all:1.10.19"
	testImplementation "commons-beanutils:commons-beanutils:1.9.3"

}

test {
	useTestNG {
	}
}
